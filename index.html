<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Spring-JDBC-ROMA : Spring JDBC extension for object mapping supported rowmapper" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Spring-JDBC-ROMA</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/serkan-ozal/spring-jdbc-roma">View on GitHub</a>

          <h1 id="project_title">Spring-JDBC-ROMA</h1>
          <h2 id="project_tagline">Spring JDBC extension for object mapping supported rowmapper</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/serkan-ozal/spring-jdbc-roma/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/serkan-ozal/spring-jdbc-roma/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h2><strong>What is Spring-JDBC-ROMA?</strong></h2>

<p><strong>Spring-JDBC-ROMA</strong> is a rowmapper extension for <strong>Spring-JDBC module</strong>. 
There is already a rowmapper named <strong>"org.springframework.jdbc.core.BeanPropertyRowMapper"</strong> for binding 
resultset attributes to object. But it is reflection based and can cause performance problems as Spring developers said.
However <strong>Spring-JDBC-ROMA</strong> is not reflection based and it is byte code generation (with <strong>CGLib</strong> and <strong>Javassist</strong>) 
based rowmapper. It generates rowmapper on the fly like implementing as manual so it has no performance overhead. 
It also supports object relations as lazy and eager. There are other lots of interesting features and 
these features can be customized with developer's extended classes. </p>

<h2><strong>What features does Spring-JDBC-ROMA have?</strong></h2>

<ul>
<li><p>All primitive types, enums, dates, collections, blob, clob and complex objects are supported.  </p></li>
<li><p>Lazy or eager field accessing is supported.   </p></li>
<li><p>Writing your custom field based <strong>RowMapperFieldGenerator</strong> implementations is supported.   </p></li>
<li><p>Writing your custom class (or type) based <strong>RowMapperFieldGeneratorFactory</strong> implementations is supported. </p></li>
<li><p>Writing field access definitions as compilable Java code in annotation or configuration file (XML file, properties file, ...) is supported.    </p></li>
</ul><h2><strong>Install</strong></h2>

<p>In your <strong>pom.xml</strong>, you must add repository and dependency for Spring-JDBC-ROMA. 
You can change <strong>spring.jdbc.roma.version</strong> to any existing <strong>spring-jdbc-roma</strong> library version.</p>

<div class="highlight"><pre>...
<span class="nt">&lt;properties&gt;</span>
    ...
    <span class="nt">&lt;spring.jdbc.roma.version&gt;</span>1.0.0-RELEASE<span class="nt">&lt;/spring.jdbc.roma.version&gt;</span>
    ...
<span class="nt">&lt;/properties&gt;</span>
...
<span class="nt">&lt;dependencies&gt;</span>
    ...
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>spring-jdbc-roma<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>${spring.jdbc.roma.version}<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    ...
<span class="nt">&lt;/dependencies&gt;</span>
...
<span class="nt">&lt;repositories&gt;</span>
    ...
    <span class="nt">&lt;repository&gt;</span>
        <span class="nt">&lt;id&gt;</span>serkanozal-maven-repository<span class="nt">&lt;/id&gt;</span>
        <span class="nt">&lt;url&gt;</span>https://github.com/serkan-ozal/maven-repository/raw/master/<span class="nt">&lt;/url&gt;</span>
    <span class="nt">&lt;/repository&gt;</span>
    ...
<span class="nt">&lt;/repositories&gt;</span>
...
</pre></div>

<p>And finally, in your <strong>Spring context xml</strong> file add following configuration to make your Spring context automatically aware of Spring-JDBC-ROMA.</p>

<div class="highlight"><pre>...
<span class="nt">&lt;import</span> <span class="na">resource=</span><span class="s">"classpath*:roma-context.xml"</span><span class="nt">/&gt;</span>
...
</pre></div>

<h2><strong>Spring-JDBC-ROMA with a simple example</strong></h2>

<p>Here is <strong>User</strong> class:  </p>

<div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>

    <span class="nd">@RowMapperField</span><span class="o">(</span><span class="n">columnName</span> <span class="o">=</span> <span class="s">"id"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="nd">@RowMapperField</span><span class="o">(</span><span class="n">columnName</span> <span class="o">=</span> <span class="s">"username"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">username</span><span class="o">;</span>
    <span class="nd">@RowMapperField</span><span class="o">(</span><span class="n">columnName</span> <span class="o">=</span> <span class="s">"password"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">password</span><span class="o">;</span>
    <span class="nd">@RowMapperField</span><span class="o">(</span><span class="n">columnName</span> <span class="o">=</span> <span class="s">"firstname"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">firstname</span><span class="o">;</span>
    <span class="nd">@RowMapperField</span><span class="o">(</span><span class="n">columnName</span> <span class="o">=</span> <span class="s">"lastname"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">lastname</span><span class="o">;</span>
    <span class="nd">@RowMapperField</span><span class="o">(</span><span class="n">columnName</span> <span class="o">=</span> <span class="s">"enabled"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">enabled</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
    <span class="nd">@RowMapperField</span><span class="o">(</span><span class="n">columnName</span> <span class="o">=</span> <span class="s">"gender"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Gender</span> <span class="n">gender</span><span class="o">;</span>
    <span class="nd">@RowMapperObjectField</span><span class="o">(</span>
        <span class="n">provideViaSpringProvider</span> <span class="o">=</span> 
            <span class="nd">@RowMapperSpringProvider</span><span class="o">(</span>
                <span class="n">provideCode</span> <span class="o">=</span> <span class="s">"@{roleDAO}.getUserRoleList(${id})"</span><span class="o">),</span>
        <span class="n">lazy</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Role</span><span class="o">&gt;</span> <span class="n">roles</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Role</span><span class="o">&gt;();</span>

    <span class="o">...</span>

<span class="o">}</span> 
</pre></div>

<p>Here is <strong>Role</strong> class:    </p>

<div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Role</span> <span class="o">{</span>

    <span class="nd">@RowMapperField</span><span class="o">(</span><span class="n">columnName</span> <span class="o">=</span> <span class="s">"id"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Long</span> <span class="n">id</span><span class="o">;</span>
    <span class="nd">@RowMapperField</span><span class="o">(</span><span class="n">columnName</span> <span class="o">=</span> <span class="s">"name"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="nd">@RowMapperObjectField</span><span class="o">(</span>
        <span class="n">provideViaSpringProvider</span> <span class="o">=</span> 
            <span class="nd">@RowMapperSpringProvider</span><span class="o">(</span>
                <span class="n">provideCode</span> <span class="o">=</span> <span class="s">"@{permissionDAO}.getRolePermissionList(${id})"</span><span class="o">),</span>
        <span class="n">lazy</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Permission</span><span class="o">&gt;</span> <span class="n">permissions</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Permission</span><span class="o">&gt;();</span>

    <span class="o">...</span>

<span class="o">}</span>
</pre></div>

<p>You can get <strong>User</strong> entity rowmapper as follows:</p>

<div class="highlight"><pre><span class="nd">@Autowired</span>
<span class="n">RowMapperService</span> <span class="n">rowMapperService</span><span class="o">;</span>

<span class="o">...</span>

<span class="n">RowMapper</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">userRowMapper</span> <span class="o">=</span> <span class="n">rowMapperService</span><span class="o">.</span><span class="na">getRowMapper</span><span class="o">(</span><span class="n">User</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</pre></div>

<p>In this example, we can get related <strong>Role</strong> entites of <strong>User</strong> entity with <strong>"@RowMapperObjectField"</strong> annotion automatically. 
We use <strong>"@RowMapperObjectField"</strong> annotation for accessing related <strong>Role</strong> entites of <strong>User</strong> entity with <strong>id</strong> attribute of User. 
We have <strong>"lazy=true"</strong> configuration, since <strong>roles</strong> field are initialized while we are accessing it first time. 
If we don't access it, it will not be set. </p>

<p>In addition, we can define <strong>User</strong> entity with compilable pure Java code as follows:</p>

<div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>

    <span class="o">...</span>

    <span class="nd">@RowMapperObjectField</span><span class="o">(</span>
        <span class="n">provideViaImplementationProvider</span> <span class="o">=</span> 
            <span class="nd">@RowMapperImplementationProvider</span><span class="o">(</span>
                <span class="n">provideCode</span> <span class="o">=</span> <span class="s">"RoleDAO.getUserRoleListAsStaticMethod(${id})"</span><span class="o">,</span> 
                <span class="n">usedClasses</span> <span class="o">=</span> <span class="o">{</span><span class="n">RoleDAO</span><span class="o">.</span><span class="na">class</span><span class="o">}),</span> 
        <span class="n">lazy</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Role</span><span class="o">&gt;</span> <span class="n">roles</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Role</span><span class="o">&gt;();</span>

    <span class="o">...</span>

<span class="o">}</span> 
</pre></div>

<p>Also, we can user our custom data provider classes these implement <strong>"RowMapperObjectFieldDataProvider"</strong> interface with its <strong>"public Object provideData(T ownerObj)"</strong> method. Here is sample usage:</p>

<div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>

    <span class="o">...</span>

    <span class="nd">@RowMapperObjectField</span><span class="o">(</span>
        <span class="n">provideViaCustomProvider</span> <span class="o">=</span> 
            <span class="nd">@RowMapperCustomProvider</span><span class="o">(</span>
                <span class="n">dataProvider</span> <span class="o">=</span> <span class="n">MyCustomDataProvider</span><span class="o">.</span><span class="na">class</span><span class="o">),</span> 
        <span class="n">lazy</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Role</span><span class="o">&gt;</span> <span class="n">roles</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Role</span><span class="o">&gt;();</span>

    <span class="o">...</span>

<span class="o">}</span> 
</pre></div>

<p>You can find all demo codes (including these samples above) at <a href="https://github.com/serkan-ozal/spring-jdbc-roma-demo">https://github.com/serkan-ozal/spring-jdbc-roma-demo</a></p>

<h2><strong>Roadmap</strong></h2>

<ul>
<li>SQL based provider will be supported for getting relations with pure SQL queries by specifying datasource as follows:</li>
</ul><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>

    <span class="o">...</span>

    <span class="nd">@RowMapperObjectField</span><span class="o">(</span>
        <span class="n">provideViaSqlProvider</span> <span class="o">=</span> 
            <span class="nd">@RowMapperSqlProvider</span><span class="o">(</span>
                <span class="n">sql</span> <span class="o">=</span> 
                    <span class="s">"SELECT r.* FROM ROLE r WHERE r.ID IN "</span> <span class="o">+</span>
                    <span class="s">"("</span> <span class="o">+</span>
                        <span class="s">"SELECT ur.ROLE_ID FROM user_role ur WHERE ur.USER_ID = ${id}"</span> <span class="o">+</span>
                    <span class="s">") ORDER BY r.name"</span><span class="o">,</span>
                <span class="n">dataSource</span> <span class="o">=</span> <span class="s">"MyDataSource"</span><span class="o">),</span>
        <span class="n">lazy</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Role</span><span class="o">&gt;</span> <span class="n">roles</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Role</span><span class="o">&gt;();</span>

    <span class="o">...</span>

<span class="o">}</span>
</pre></div>

<ul>
<li>Field based formatters will be supported for formating field from raw value by impelenting custom formatter classes from <strong>"RowMapperFieldGeneratorFormatter"</strong> interface and overriding <strong>"public T format(T value)"</strong> method. Here is sample usage:</li>
</ul><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>

    <span class="o">...</span>

    <span class="nd">@RowMapperField</span><span class="o">(</span>
        <span class="n">columnName</span> <span class="o">=</span> <span class="s">"surname"</span><span class="o">,</span> 
        <span class="n">fieldFormatters</span> <span class="o">=</span> <span class="o">{</span><span class="n">MyTrimFormatter</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">MyUpperCaseFormatter</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">surname</span><span class="o">;</span>

    <span class="o">...</span>

<span class="o">}</span>
</pre></div>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Spring-JDBC-ROMA maintained by <a href="https://github.com/serkan-ozal">serkan-ozal</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-40652716-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
